# CelestiaNote -セレスティアノート-
### by SnailPop


## 概要

**CelestiaNote -セレスティアノート-** は、Three.jsとTextAlive App APIを用いたインタラクティブな星空音楽ビジュアライザーです。
あなたが選んだ楽曲の歌詞が夜空の星のように輝き、星座を形成します。あなたの操作によって、星空が"育っていく"ように変化し、音楽と歌詞の幻想的な体験が楽しめます。

## アプリケーションの流れ

### 1.初期表示
- 星空とステージが表示され、WASDキーまたは矢印キーで移動、マウスドラッグで視点移動が可能です。
- マイクスタンドをクリックすると、その上にホログラム風の楽曲選択UIが出現します。
（誘導用のUIをクリックしても反応するようにしています。）

### 2.楽曲選択
- 左右の矢印で曲を切り替え、再生ボタンで曲の再生が開始されます。
- 再生中はシークバーによって再生位置の変更も可能です。
- マジカルミライ2025課題曲すべてに対応しています。また、タイトル、アーティスト、URL、beatId、chordId、repetitiveSegmentId、lyricId、lyricDiffIdが存在する曲に対応できます。

### 3.望遠鏡での星空観察シーン
- 曲選択後、望遠鏡をクリックすると、視点が望遠鏡にズームし星空観察シーンに移行します。
- 曲の再生タイミングに合わせて、歌詞が星の粒子として空に出現します。
- その中に隠された"星座候補"があり、歌詞表示時に示されるヒントを用いて、適切な位置に歌詞を表示できると、星座が出現し、周囲の演出が少しづつ変化していきます。

### 4.星空の観賞シーンへ
- 曲の終了後、あなたが自ら創り出した星空を自由視点で観賞できるシーンに移行します。
- 曲はループ再生され、星空観察シーンで表示した歌詞が、同じタイミング、同じ座標で再び出現します。
- 星座の発見数は記録され、アンプをクリックすると取集状況と達成度に応じたメッセージを見ることができます。
- 星座の発見数が多いほど、視覚演出が華やかになります。


## 特徴

- **視点操作・移動：** WASD/十字キーで移動が、マウス左クリック＆ドラッグで視点回転ができます。
- **星空のレンダリング：** Three.jsによってリアルタイムな星空描画を行っています。
- **歌詞の星化表現：** TextAlive APIと連携した歌詞が、星の粒子となって歌詞タイミングで出現します。
- **星座の探索：** ランダムに指定された位置に歌詞を表示できると、星座が生成されます。生成された個数によって演出が変わります。
- **UI表現：** CSSRendererで3D空間にホログラムUIを実装しています。（曲選択・誘導メッセージなど）
- **アニメーション演出：** GSAPによる、カメラや星の動きの滑らかなアニメーションを実装しています。

## 使用技術

- JavaScript (ES6 Modules)  
- [Three.js](https://threejs.org)：3Dシーンの構築・レンダリング
- [TextAlive App API](https://developer.textalive.jp/)：歌詞データと音楽再生の制御
- [GSAP](https://gsap.com/)：アニメーション制御
- [Webpack](https://webpack.js.org/)：モジュールバンドル・ビルド管理 
- [CSS3DRenderer](https://threejs.org/docs/#examples/en/renderers/CSS3DRenderer)：HTMLベースのUIを3D空間に配置

## 動作環境

PCでの閲覧を推奨
- GPU搭載PC推奨（スマートフォン、タブレットは非対応）
- Google Chrome（最新版推奨）
- Node.Js v16以上（推奨）

## インストールと起動

### 1.リポジトリをクローンまたはZIPでダウンロード
```sh
git clone https://github.com/Snail365/CelestiaNote.git
cd CelestiaNote
```

### 2.依存パッケージのインストール
```sh
npm install
```

### 3.ビルド
```sh
npm run build
```

### 4.本番用ローカルサーバ起動（別途 serve 等が必要）
```sh
npx serve dist
```

### 開発用に起動する場合

webpack.config.js の以下の設定を編集

```sh
// devtool: false, // コメントアウト
mode: 'development'
```

開発サーバ起動：
```sh
npm run build 
npm start
```

## ファイル内容

- src/ -- ソースコード(JavaScript, CSS, HTMLテンプレート、モデルなど)
- dist/ -- ビルド成果物（デプロイ用）
- webpack.config.js -- Webpack設定
- package.json -- 依存管理とスクリプト

## ライセンス

使用ライブラリ（Three.js, TextAlive App APIなど）は各ライセンスに準拠します。
3Dモデル、テクスチャ、画像ファイルなどのアセットはすべて自作です。